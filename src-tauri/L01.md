Got it â€” L01 (EnCase Logical Evidence).
Same treatment as AD1 and 7z: exact hex, where it lives, and how tools detect it, written spec-style and honest about whatâ€™s fixed vs variable.

Below is one clean Markdown block you can copy directly.

â¸»

ðŸ“ L01_RECORD_LAYOUT.md

# L01 Container â€” Hex Headers, Record Layout, and Detection
## EnCase Logical Evidence File (.L01)

L01 is a **logical evidence container** used by EnCase.
It is **not** a disk image and **not** a ZIP-like archive.

L01 is:
- record-based
- segmentable (.L01, .L02, â€¦)
- metadata-rich
- proprietary (Guidance Software / OpenText)

---

## 1. L01 File Header (Container-Level)

### Primary Magic (Offset 0x00)

ASCII:

EVF

Hex:

45 56 46

This is the **same base signature family** used by:
- E01 (physical images)
- L01 (logical evidence)

ðŸ‘‰ The difference is **container type**, not magic.

---

## 2. EVF Header Block (L01 Context)

After the magic, EVF-style headers follow.

### Common Header Layout (Observed)

| Offset | Size | Field |
|------:|-----:|------|
| 0x00 | 3 | Magic `EVF` |
| 0x03 | 1 | 0x01 |
| 0x04 | 2 | Format version |
| 0x06 | 2 | Header flags |
| 0x08 | 8 | Segment number |
| 0x10 | 8 | Total segments |
| 0x18 | 8 | Section offset |
| 0x20 | â€¦ | Section table begins |

âš ï¸ Exact offsets may vary slightly, but:
- magic
- segmented structure
- section-based layout
are consistent.

---

## 3. L01 vs E01 â€” Critical Difference

| Feature | E01 | L01 |
|------|----|----|
| Physical sectors | âœ… | âŒ |
| Logical files | âŒ | âœ… |
| Directory tree | âŒ | âœ… |
| Chunked data | âœ… | âœ… |
| EVF sections | âœ… | âœ… |

Detection requires reading **section metadata**, not just the magic.

---

## 4. EVF Sections (Core Concept)

L01 uses **EVF sections**, each with a header.

### Section Header (Generic)

| Offset | Size | Field |
|------:|-----:|------|
| 0x00 | 4 | Section type |
| 0x04 | 8 | Section size |
| 0x0C | 8 | Next section offset |
| 0x14 | â€¦ | Section payload |

---

## 5. Key Section Types in L01

| Section | Purpose |
|------|-------|
| `header` | Case metadata |
| `volume` | Logical container root |
| `directory` | Directory entries |
| `file` | File metadata |
| `data` | File content chunks |
| `hash` | Declared hashes |
| `table` | Object lookup |

ðŸ“Œ These replace sectors used in E01.

---

## 6. Logical File Records

Logical files are described by **file sections**, not sectors.

### File Metadata (Conceptual)

| Field | Meaning |
|----|----|
| File ID | Unique logical object |
| Parent ID | Directory relationship |
| Filename | UTF-16LE |
| Size | Logical file size |
| Timestamps | MAC times |
| Attributes | FAT/NTFS-style |

---

## 7. File Data Storage

File contents are stored in **data sections**, often chunked.

Mapping:

File ID â†’ Data Sections â†’ Byte Offsets â†’ Content

Chunks must be:
- ordered
- concatenated
- verified

---

## 8. Hashing in L01

L01 may store:
- per-file hashes
- container-level hashes
- segment hashes

These are **declared hashes**.

Forensic validation requires:
- recomputing hashes from reconstructed file content
- comparing to declared values

---

## 9. Segmentation (.L01, .L02, â€¦)

- L01 containers are commonly segmented
- Each segment shares metadata
- All segments must be present for full reconstruction

Detection:
- segment number fields
- consistent EVF headers across segments

---

## 10. L01 Detection Algorithm (Tool-Grade)

1. Read offset 0x00:

45 56 46

2. Parse EVF header
3. Inspect section table
4. If sections describe:
- directories
- logical files
- file data chunks
â†’ classify as **L01 (logical EVF)**

Else if sections describe sectors â†’ E01.

---

## 11. Why L01 Has No Unique Magic

L01 is a **mode of EVF**, not a separate format.

Identity is determined by:
- section semantics
- object relationships
- absence of sector-based addressing

---

## 12. Hashing Rules (Forensic)

- Container hash â†’ integrity of delivered evidence
- File hashes â†’ evidentiary verification
- Declared hashes â†’ consistency check

---

## Report-Safe Language

> The evidence was identified as an EnCase logical evidence container (L01) based on EVF headers and section structures consistent with logical file records rather than physical sector data.
